<!DOCTYPE html>
<html lang="vi" class="pokemon">
<head>
  <meta charset="UTF-8" />
  <title>üéÆ Pok√©mon Battle ‚Äî ƒê·ªëi kh√°ng n√≥i</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Retro game font -->
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Nunito:wght@400;700&display=swap" rel="stylesheet">

  <style>
    :root {
      /* Pok√©mon core palette */
      --pk-blue: #3b4cca;
      --pk-yellow: #ffcb05;
      --pk-red: #e3350d;
      --pk-green: #2ecc71;
      --pk-dark: #1b1f3a;
      --pk-card: #ffffff;
      --pk-border: #dbe0f3;

      /* UI */
      --bg: #f5f7ff;
      --fg: #0f1225;
      --muted: #6b7280;

      /* Arena */
      --arena-sand: #f4e7c5;
      --arena-grass: #e8f7e1;
      --arena-line: #d0d7ec;
    }

    * { box-sizing: border-box; }
    html, body { margin: 0; padding: 0; }
    body {
      color: var(--fg);
      background:
        radial-gradient(ellipse at top left, rgba(255,203,5,0.15), transparent 60%),
        radial-gradient(ellipse at bottom right, rgba(59,76,202,0.18), transparent 60%),
        linear-gradient(180deg, #f9fbff, #eef2ff);
      min-height: 100vh;
      font-family: 'Nunito', system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    }

    /* Header */
    .header {
      background:
        linear-gradient(180deg, rgba(59,76,202,0.18), rgba(59,76,202,0.10)),
        linear-gradient(180deg, #ffffff, #f4f6ff);
      border-bottom: 4px solid var(--pk-blue);
      position: sticky;
      top: 0;
      z-index: 10;
    }
    .header-inner {
      max-width: 1080px;
      margin: 0 auto;
      padding: 16px 20px;
      display: flex;
      align-items: center;
      gap: 14px;
    }
    .logo-ball {
      width: 44px;
      height: 44px;
      border-radius: 50%;
      background:
        radial-gradient(circle at 50% 35%, #fff 0 18px, transparent 19px),
        linear-gradient(180deg, #ffffff 0 50%, #e74c3c 51% 100%);
      border: 3px solid #111;
      position: relative;
      box-shadow: 0 2px 0 #111, 0 6px 18px rgba(0,0,0,0.1);
    }
    .logo-ball::after {
      content: "";
      position: absolute;
      left: 50%; top: 50%;
      transform: translate(-50%, -50%);
      width: 14px; height: 14px;
      border-radius: 50%;
      background: #fff;
      border: 3px solid #111;
      box-shadow: inset 0 0 0 3px #fff;
    }
    .title-wrap h1 {
      font-family: 'Press Start 2P', monospace;
      font-size: 18px;
      line-height: 1.3;
      margin: 0;
      color: var(--pk-blue);
      text-shadow: 0 2px 0 #fff, 2px 2px 0 rgba(59,76,202,0.15);
    }
    .title-wrap .subtitle {
      margin-top: 6px;
      font-size: 13px;
      color: var(--muted);
    }

    /* Container cards */
    .container {
      max-width: 1080px;
      margin: 18px auto;
      padding: 0 20px 24px;
    }
    .card {
      background: var(--pk-card);
      border: 2px solid var(--pk-border);
      border-radius: 16px;
      box-shadow: 0 10px 30px rgba(59,76,202,0.08);
      padding: 16px;
      margin-bottom: 16px;
    }

    /* Top controls */
    .row { margin: 10px 0; }
    .flex { display: flex; gap: 12px; align-items: center; flex-wrap: wrap; }
    .split { display: flex; align-items: center; justify-content: space-between; gap: 12px; flex-wrap: wrap; }
    .pill {
      display: inline-flex; align-items: center; gap: 8px;
      padding: 6px 12px; border-radius: 999px;
      background: #f0f3ff; color: #162466;
      border: 2px solid var(--pk-border);
      font-weight: 700;
    }
    .muted { color: var(--muted); }

    label { font-weight: 700; color: #26357a; }
    select, button {
      border-radius: 12px; border: 2px solid var(--pk-blue);
      padding: 10px 14px; background: #fff; color: var(--pk-blue);
      font-weight: 800;
      box-shadow: 0 4px 0 rgba(59,76,202,0.3);
      transition: transform 0.1s ease, box-shadow 0.1s ease, background 0.2s;
    }
    select { min-width: 120px; }
    button:hover { transform: translateY(-1px); box-shadow: 0 6px 0 rgba(59,76,202,0.3); }
    button:active { transform: translateY(0); box-shadow: 0 2px 0 rgba(59,76,202,0.3); }
    button:disabled { opacity: 0.6; cursor: not-allowed; }

    .btn-join { background: linear-gradient(#fffdff, #fff4bf); border-color: var(--pk-yellow); color: #7a5a00; }
    .btn-leave { background: linear-gradient(#fff5f5, #ffdada); border-color: var(--pk-red); color: #7a0e00; }
    .btn-confirm {
      background: linear-gradient(#ffe3e3, #ffc2c2);
      border-color: #b41010; color: #7a0000;
      display: none;
    }

    /* Battle status bar */
    .status-bar {
      display: flex; align-items: center; gap: 10px; min-height: 40px;
      background: linear-gradient(180deg, #ffffff, #f9fbff);
      border: 2px dashed var(--pk-border);
      border-radius: 12px;
      padding: 10px 12px;
    }
    .status-dot {
      width: 10px; height: 10px; border-radius: 50%;
      background: var(--pk-yellow); box-shadow: 0 0 0 3px rgba(255,203,5,0.25);
      animation: pulse 1.8s infinite ease-in-out;
    }
    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.25); }
    }

    /* Arena */
    #gameArea { display: none; }
    .arena {
      border-radius: 16px;
      overflow: hidden;
      border: 3px solid var(--pk-blue);
      background:
        radial-gradient(circle at 50% 110%, rgba(0,0,0,0.08), transparent 40%),
        linear-gradient(180deg, var(--arena-grass), var(--arena-sand));
      padding: 16px;
    }

    .trainer-row {
      display: grid;
      grid-template-columns: 1fr auto 1fr;
      gap: 12px;
      align-items: start;
    }

    .trainer {
      background: #ffffffcf;
      border: 2px solid var(--pk-border);
      border-radius: 14px;
      padding: 12px;
      position: relative;
      min-height: 84px;
    }
    .trainer h4 {
      margin: 0 0 8px;
      font-family: 'Press Start 2P', monospace;
      font-size: 12px; color: var(--pk-dark);
      white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
    }
    .hp-bar {
      height: 12px; border-radius: 10px;
      background: #f0f3ff; border: 2px solid var(--pk-border);
      position: relative; overflow: hidden;
    }
    .hp-fill {
      height: 100%;
      width: 100%;
      background: linear-gradient(90deg, #2ecc71, #9be49f);
    }

    .vs-badge {
      align-self: center;
      font-family: 'Press Start 2P', monospace;
      font-size: 14px;
      color: #fff;
      background: linear-gradient(180deg, #3b4cca, #25318f);
      border: 3px solid #11193a;
      border-radius: 14px;
      padding: 10px 12px;
      box-shadow: 0 6px 0 rgba(17, 25, 58, 0.35), inset 0 -3px 0 rgba(255,255,255,0.2);
    }

    /* Middle lane: chat/questions */
    .lane {
      display: grid;
      grid-template-columns: 1fr minmax(280px, 1.4fr) 1fr;
      gap: 12px;
      margin-top: 12px;
      align-items: stretch;
    }

    .score {
      font-family: 'Press Start 2P', monospace;
      font-size: 20px;
      color: #10205a;
      background: #fff;
      border: 3px solid var(--pk-blue);
      border-radius: 10px;
      min-width: 86px;
      text-align: center;
      display: grid; place-items: center;
      box-shadow: 0 6px 0 rgba(59,76,202,0.25);
    }
    .score::before {
      content: "HP";
      position: absolute;
      margin-top: -34px;
      font-size: 10px; color: #31428f;
      letter-spacing: 1px;
    }

    .chat {
      background: #fff;
      border: 3px solid var(--arena-line);
      border-radius: 14px;
      padding: 10px;
      display: flex; flex-direction: column; gap: 6px;
      max-height: 300px; overflow-y: auto;
      box-shadow: inset 0 0 0 2px #fff;
    }
    .bubble {
      padding: 8px 10px; border-radius: 10px;
      border: 2px solid var(--pk-border);
      background: #f6f8ff;
      color: #1d2b6f;
      width: fit-content; max-width: 100%;
    }
    .bubble.me { margin-left: auto; background: #fff6d1; color: #6a5100; border-color: #ffe082; }

    /* HUD */
    .hud {
      display: flex; align-items: center; gap: 12px; margin-top: 12px;
    }
    .chip {
      background: #f0f3ff;
      border: 2px solid var(--pk-border);
      border-radius: 12px;
      padding: 8px 10px;
      font-weight: 800; color: #1a2b7a;
    }
    #progressWrap {
      flex: 1; background: #e4e8ff; height: 10px; border-radius: 999px;
      border: 2px solid var(--pk-border); overflow: hidden;
      box-shadow: inset 0 2px 0 rgba(59,76,202,0.15);
    }
    #progressBar {
      height: 100%; width: 0%;
      background: linear-gradient(90deg, #2ecc71, #9be49f);
      transition: width 0.2s linear;
    }

    /* Name badges */
    .badge {
      display: inline-block;
      padding: 4px 10px;
      border-radius: 999px;
      font-weight: 800;
      border: 2px solid var(--pk-blue);
      background: #fff;
      color: var(--pk-blue);
    }
    .badge.red   { background: #ffe0e0; border-color: #d85b5b; color: #7a0e00; }
    .badge.green { background: #e0ffe8; border-color: #3aa060; color: #0d5a30; }

    /* Record area */
    .record-row {
      display: flex; align-items: center; gap: 10px; margin-top: 12px;
    }
    .btn-mic {
      background: linear-gradient(#fff, #eaf2ff);
      border-color: var(--pk-blue);
      color: var(--pk-blue);
    }
    .btn-mic[disabled] {
      opacity: 0.6;
    }

    /* Layout helpers */
    .grid2 { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
    .center { display: grid; place-items: center; }

    @media (max-width: 860px) {
      .trainer-row { grid-template-columns: 1fr; }
      .lane { grid-template-columns: 1fr; }
      .score::before { display: none; }
    }
  </style>
</head>
<body>
  <!-- Header -->
  <header class="header">
    <div class="header-inner">
      <div class="logo-ball" aria-hidden="true"></div>
      <div class="title-wrap">
        <h1>Pok√©mon Battle ‚Äî ƒê·ªëi kh√°ng n√≥i</h1>
        <div class="subtitle">Ch·ªçn tr√¨nh ƒë·ªô ‚Äî V√†o ph√≤ng ‚Äî Chi·∫øn ƒë·∫•u theo l∆∞·ª£t nh∆∞ m·ªôt tr·∫≠n Pok√©mon!</div>
      </div>
    </div>
  </header>

  <!-- Content -->
  <main class="container">
    <!-- Top controls -->
    <section class="card">
      <div class="row flex">
        <div>
          <span class="pill">
            üë§ Ng∆∞·ªùi ch∆°i:
            <strong id="meName" style="font-family:'Press Start 2P', monospace;"></strong>
          </span>
        </div>
        <div class="flex">
          <label>Ch·ªçn tr√¨nh ƒë·ªô:
            <select id="levelSelect">
              <option value="2">L·ªõp 2</option>
              <option value="3">L·ªõp 3</option>
              <option value="4">L·ªõp 4</option>
              <option value="5">L·ªõp 5</option>
              <option value="6">L·ªõp 6</option>
            </select>
          </label>
          <button id="joinBtn" class="btn-join">Tham gia</button>
          <button id="leaveBtn" class="btn-leave">Tho√°t ph√≤ng</button>
        </div>
      </div>

      <div class="status-bar row" id="status">
        <span class="status-dot"></span>
        <span class="muted">Ch∆∞a tham gia ph√≤ng.</span>
      </div>

      <!-- P1 confirm -->
      <div class="row">
        <button id="confirmBtn" class="btn-confirm">OK ‚Äî B·∫Øt ƒë·∫ßu tr·∫≠n</button>
      </div>
    </section>

    <!-- Arena -->
    <section id="gameArea" class="arena">
      <!-- Top info -->
      <div class="row split">
        <div>Ph√≤ng: <strong><span id="roomId" style="font-family:'Press Start 2P'"></span></strong></div>
        <div>Tr√¨nh ƒë·ªô: <strong><span id="roomLevel" style="font-family:'Press Start 2P'"></span></strong></div>
        <div>L∆∞·ª£t: <strong><span id="turnIndex">0</span>/20</strong></div>
      </div>

      <!-- Trainers -->
      <div class="trainer-row">
        <div class="trainer">
          <h4>Ng∆∞·ªùi ch∆°i 1</h4>
          <div class="badge" id="p1">‚Äî</div>
          <div class="hp-bar" style="margin-top:8px;"><div class="hp-fill" id="hpP1"></div></div>
        </div>

        <div class="vs-badge">VS</div>

        <div class="trainer">
          <h4>Ng∆∞·ªùi ch∆°i 2</h4>
          <div class="badge" id="p2">‚Äî</div>
          <div class="hp-bar" style="margin-top:8px;"><div class="hp-fill" id="hpP2"></div></div>
        </div>
      </div>

      <!-- HUD -->
      <div id="hud" class="row">
        <div class="chip">ƒêang t·ªõi l∆∞·ª£t: <strong><span id="currentTurn">‚Äî</span></strong></div>
        <div id="progressWrap"><div id="progressBar"></div></div>
        <div class="chip">M·ªëc: <span id="turnSeconds">0</span>s / 10s</div>
      </div>

      <!-- Middle lane -->
      <div class="lane row">
        <div class="score center" id="scoreP1">0</div>

        <div id="chatBox" class="chat"></div>

        <div class="score center" id="scoreP2">0</div>
      </div>

      <!-- Controls -->
      <div class="record-row row">
        <button id="recordBtn" class="btn-mic" disabled>üé§ Ghi √¢m</button>
        <span class="muted">Ch·ªâ b·∫≠t khi t·ªõi l∆∞·ª£t b·∫°n</span>
      </div>

      <div id="speechResult" class="row"></div>
    </section>
  </main>

  <!-- Your game logic -->
  <script type="module" src="fight.js"></script>
</body>
</html>
